define("render",["lodash","coreUtils","warmup","utils","core","reactDOM"],function(a,b,c,d,e,f){"use strict";var g=typeof window!=="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now.bind(Date);function h(a,b){var c=b.query;var d=c.configName||"fullFunctionality";var e=a[d]||a.fullFunctionality;var f=e.getConfig();if(!c.dsOrigin){throw new Error("You must define dsOrigin parameter in order to use the documentServices - please speak to html-server team for a key")}f.origin=c.dsOrigin;return f}function i(b,c,e){var f=a(e).keys().pull("masterPage").value();return a.mapValues(e,function(a,e){if(c&&window.pagesData&&window.pagesData[e]){return a}return d.dataFixer.fix(a,f.slice(),b.requestModel,b.currentUrl,b.urlFormatModel,b.viewMode==="site",b.rendererModel.clientSpecMap)})}function j(b,d,h,i,j){e.renderer.renderSite(d,h,i,function(d){if(window.rendered){window.rendered.forceUpdate()}else{var e=window.document.getElementById("SITE_CONTAINER").children[0];window.rendered=f.render(d,window.document.getElementById("SITE_CONTAINER"));var h=window.document.getElementById("SITE_CONTAINER").children[0];if(window.sssr){window.sssr.success=e===h;window.sssr.clientSideRender={sinceInitialTimestamp:Date.now()-window.wixBiSession.initialTimestamp,performanceNow:g()};c.indicator.updateState(window.sssr.success?c.indicator.STATES.SUCCESS:c.indicator.STATES.FAIL);if(window.sssr.success){c.iframes.flushEvents()}}window.onpopstate=window.rendered.onPopState;window.onhashchange=window.rendered.onHashChange;if(window.parent){window.rendered.registerAspectToEvent("siteReady",function(){if(j){j(window.rendered)}if(window.documentServices){window.parent.postMessage("documentServicesLoaded","*")}})}if(b.qaAutomation){a.set(window,"testApi.domSelectors",b.qaAutomation.getDomSelectors(b.react,b.reactDOM));window.testApi.domSelectors.setSearchRoot(window.rendered);a.set(window,"testApi.isReady",true)}}})}function k(c,d,f){var g={};if(b.urlUtils.isQueryParamOn(f.currentUrl,"isSantaEditor")){g=a.assign(g,{componentViewMode:"editor"})}if(f.rendererModel.previewMode){g=a.assign(g,{isSocialInteractionAllowed:false,isPlayingAllowed:false})}f.renderFlags=a.assign({},f.renderFlags,g);var h=new e.SiteData(f);var i=e.SiteDataAPI.createSiteDataAPIAndDal(h,d);var j=i.siteData;var k=i.siteDataAPI;var l={pointers:i.pointers,displayedDAL:i.displayedDal,siteDataAPI:k};var m=false;return{fullSiteData:h,displayedSiteData:j,siteDataWrapper:i,viewerPrivateServices:l,isServerSideRender:m,siteModel:f,siteDataAPI:k}}function l(b,c,e,f,g){var l=k(b,c,e);var m=b.documentServices;try{if(m&&a.isUndefined(window.karmaIntegration)&&window.parent.FS){d.integrations.fullStory.start()}}catch(a){}if(m){l.siteDataWrapper.dataLoadedRegistrar=l.siteDataAPI.registerDataLoadedCallback.bind(l.siteDataAPI);window.documentServices=new m.Site(h(m.configs,l.siteModel.currentUrl),l.siteDataWrapper,a.partial(i,l.siteModel,l.isServerSideRender),a.partial(j,b,l.displayedSiteData,l.viewerPrivateServices,f));a.set(window,"testApi.documentServices",window.documentServices)}else{var n=l.fullSiteData.pagesData;l.fullSiteData.pagesData=n&&i(l.siteModel,l.isServerSideRender,n);if(n.masterPage){l.siteDataAPI.createDisplayedPage("masterPage")}j(b,l.displayedSiteData,l.viewerPrivateServices,f,g)}}return{clientSide:l}});